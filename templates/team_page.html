<!DOCTYPE html>
<html>
<head>
	{% include 'headers.html' %}
	{% set team_qrs_dict = team_qrs.to_dict() %}
	<title>{{ team.name }}</title>
	<style type="text/css">
		body {
			background-color: {{ team.color.colors[1] }};
		}
		.jumbotron {
			background-color: {{ team.color.colors[0] }};
		}
		.element {
			background-color: {{ team.color.colors[0] }}80;
		}
		div.element span {
			background-color: {{ team.color.colors[0] }}C0;
		}
	</style>
</head>
<body>
	<div class="jumbotron">
		<div class="row text-center">
			<h2 class="col-12">&#x1F530; {{ team.name }} &#x1F530;</h2>
		</div>
	</div>
	<div class="container">
		<div class="row">


			<div class="col-12 col-md-6 col-xl-4 element-container">
				<div class="element text-center">
					<h2>{{ team.points }} &#x1F3C6;</h2>
				</div>
			</div>

			<div class="col-12 col-md-6 col-xl-4 element-container">
				<div class="element">
					<h3>&#x1F64B; Members</h3>
					<hr>
					<div class="box-list">
						{% for teammate in teammates %}
							<span class="clickable-spans">
							{% if teammate.user_id != user_id and user_id == team.owner %}
							<a href="/team/owner?user={{ teammate.user_id }}" onclick="return change_owner('{{ teammate.name }}')">
							{% endif %}
								{% if teammate.user_id == team.owner %}&#x1F451; {% endif %}
								{% if teammate.user_id == user_id %}&#x1F600; {% endif %}
								{{ teammate.name }}
							</span>
							{% if teammate.user_id != user_id and user_id == team.owner %}
							</a>
							{% endif %}
						{% endfor %}
					</div>
				</div>
			</div>

			{% if qrs.qrcodes %}
				<div class="col-12 col-md-6 col-xl-4 element-container">
					<div class="element">
						<h3>&#x1F92B; Secret QR Codes</h3>
						<hr>
						<div class="box-list clickable-spans">
							{% for qr in qrs.qrcodes %}
								{% if qr.qr_id in team_qrs_dict %}
									<span onclick="alert(`You found '{{ qr.description }}'!`);">
										&#x1F535; {{ qr.points }}&#x1F3C6;
									</span>
								{% else %}
									<span onclick="alert(`You didn't find this QR code!`);">
										&#x1F534; {{ qr.points }}&#x1F3C6;
									</span>
								{% endif %}
							{% endfor %}
						</div>
					</div>
				</div>
			{% endif %}

			{% for obj in objectives %}		
			<div class="col-12 col-md-6 col-xl-4 element-container">
				<div class="element">
					<h3>&#x1F5BC; {{ obj.description }}</h3>
					<hr>
					{% if obj.obj_id in pictures %}
						{% if edit or pictures[obj.obj_id].status == 1%}
							<img class="obj-img" src="/picture/{{ pictures[obj.obj_id].filename }}">
						{% else %}
							<h1 class="text-center">&#x1F622;</h1>
						{% endif %}
					{% elif edit %}
					<form action="/team/picture/add" method=post enctype=multipart/form-data class="text-center">
						<input type="hidden" name="obj_id" value="{{ obj.obj_id }}">
						<input id="file-{{ obj.obj_id }}" type="file" name="file" accept="image/*" onchange="this.form.submit()" hidden>
						<label for="file-{{ obj.obj_id }}">
							<h1>&#x1F4F8;</h1>
						</label>
					</form>
					{% else %}
						<h1 class="text-center">&#x1F622;</h1>
					{% endif %}
					<hr>
					<div class="obj-row">
						<h5 class="obj-points">&#x1F3C6;{{ obj.points }}</h5>
						{% if obj.obj_id in pictures and edit %}
							<h5 class="obj-points">
								{% if user_id == team.owner %}
								<a href="/team/picture/delete?obj_id={{ obj.obj_id }}" onclick="return delete_picture()">
									&#x274C;
								</a>
								{% else %}
								<a onclick="return not_the_owner()">
									&#x274C;
								</a>
								{% endif %}
							</h5>
						{% endif %}
					</div>
				</div>
			</div>
			{% endfor %}

			<div class="col-12 col-md-6 col-xl-4 element-container">
				<div class="element">
					<h3>&#x1F517; Links</h3>
					<hr>
					<div class="box-list">
						<span>
							<a href="/home">&#x1F3E1; Home</a>
						</span>
						{% if edit %}
						<span>
							<a href="/team/leave" onclick="return confirm('Are you sure you want to leave?')">
								&#x1F44B; Leave Team
							</a>
						</span>
						{% else %}
						<span>
							<a href="/team">&#x1F64F; My team</a>
						</span>
						{% endif %}
					</div>
				</div>
			</div>


		</div>
	</div>
	{% include 'footers.html' %}
	<script type="text/javascript">
		function delete_picture() {
			return confirm("Are you sure you want to delete this picture?");
		}
		function not_the_owner() {
			return alert("Only the owner of the team can delete a picture");
		}
		function change_owner(username) {
			return confirm(`Make ${username} the leader of the team?`)
		}
	</script>
</body>
</html>
